# 데이터베이스(2)

> **원본 포스트 ID**: 193
> **발행일**: 2025-06-17 00:36:42
> **카테고리**: project/웹개발

## 📝 원문 내용

**Sequelize로 데이터 저장/조회 API 만들기**

* * *

**mainRouter 파일에 API 추가하기**

**데이터 저장 API**

router.get("/data/create",function(req,res){

let user_id = parseInt(Math.random() * 10000)

db.users.create({user_id:user_id}).then(function(result){

res.send({success:200})

})

})

라우팅 경로  
GET /data/create 요청이 들어오면 실행됩니다.

랜덤 숫자 생성

  
Math.random() * 10000: 0부터 9999까지의 실수형 랜덤 숫자를 생성  
parseInt(...): 소수점 제거 → 정수형으로 변환

![](./img/193_img.png)

DB Insert 수행  
db.users.create(...): Sequelize ORM을 통해 users 테이블에 새로운 row를 생성  
예: { user_id: 7231 } 이런 형태로 삽입

결과 응답  
삽입 완료 후 { success: 200 } 응답을 클라이언트에 반환

![](./img/193_img_1.png)

**데이터 조회 API**

router.get("/data/read", function(req,res){

db.users.findAll().then(function(result){

res.send({success:200, data:result})

})

})

너무 간단하게도, findAll 함수를 사용하면 users 테이블에 저장된 모든 데이터들을 조회하여 가져옵니다.

이것 또한 바로 res.send 즉 호출한 개발자(프론트엔드)에게 응답으로 보내줍니다. 그 모습은 어려울 것 없이 딕셔너리 형태 즉 객체입니다.

![](./img/193_img_2.png)

**Sequelize로 데이터 변경/삭제 API 만들기**

* * *

**데이터 변경 API**

router.post("/data/update", function(req,res){

let target_id = req.body.target_id;

db.users.update({user_id:9999},{where:{user_id:target_id}}).then(function(result){

res.send({success:200})

})

})

router.post("/data/update", function(req, res) {

  * Express 라우터 정의입니다.
  * 클라이언트가 POST 방식으로 /data/update 경로에 요청을 보내면 이 함수가 실행됩니다.



let target_id = req.body.target_id;

  * req.body는 요청 본문에서 데이터를 가져옵니다.
  * target_id는 수정 대상이 되는 사용자의 user_id입니다.
  * 예: 사용자가 { "target_id": "1234" }를 보내면 target_id = 1234



db.users.update(...)

  * Sequelize의 update() 함수를 사용해서 users 테이블의 값을 수정합니다.
  * 두 개의 인자를 가집니다:



첫 번째 인자

javascript

복사편집

{ user_id: 9999 } 

  * 해당 조건을 만족하는 레코드의 user_id 값을 9999로 바꾸겠다는 의미입니다.



두 번째 인자

javascript

복사편집

{ where: { user_id: target_id } } 

  * user_id가 target_id와 일치하는 레코드만 수정하겠다는 의미입니다.



then(function(result) { res.send({ success: 200 }); })

  * 업데이트가 성공적으로 끝났을 때 실행됩니다.
  * 응답으로 { success: 200 } JSON을 클라이언트에 반환합니다.
  * 참고로 result는 [1] 또는 [0]의 배열입니다: 
    * [1]: 1개의 레코드가 수정됨
    * [0]: 조건에 맞는 레코드가 없어 아무것도 수정 안 됨



![](./img/193_img_3.png)

이제 조회 API로 확인해보면 9999로 바뀌어있을껍니다.

![](./img/193_img_4.png)

**데이터 삭제****API**

router.post("/data/delete",function(req,res){

let target_id = req.body.target_id;

db.users.destroy({where:{users_id:target_id}}).then(function(result){

res.send({success:200})

})

})

let target_id = req.body.target_id;

  * req.body에서 target_id를 꺼냅니다.
  * 예: 클라이언트가 {"target_id": 5}를 보내면 target_id = 5



db.users.destroy({ where: { user_id: target_id } })

  * users 테이블에서 user_id가 target_id인 레코드를 삭제합니다.
  * SQL로 보면 다음과 비슷한 작업입니다:



DELETE FROM users WHERE user_id = 5;

![](./img/193_img_5.png) ![](./img/193_img_6.png)

이런식으로 데이터 칸이 삭제된걸 볼 수 있습니다.


## 🔗 제텔카스텐 연결

### 관련 개념
- [[]]
- [[]]

### 프로젝트 연결
- [[]]

### 학습 포인트
-

## 📋 액션 아이템
- [ ]
- [ ]

## 💡 개인적 통찰



---

**태그**: #project웹개발
**상태**: 🌱 씨앗 (제텔카스텐 통합 대기)
**변환일**: 2025-10-07
