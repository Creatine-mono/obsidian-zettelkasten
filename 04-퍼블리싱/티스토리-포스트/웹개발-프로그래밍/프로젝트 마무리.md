# 프로젝트 마무리

> **원본 포스트 ID**: 194
> **발행일**: 2025-06-17 16:59:02
> **카테고리**: project/웹개발

## 📝 원문 내용

**영화 리뷰 사이트 주소 만들기**

* * *

영화리뷰 메인 페이지인 main.html 파일의 코드를 views 폴더의 main.ejs 파일로 옮겨옵니다

![](./img/194_img.png)

주소 라우터에 index.ejs 그림 파일을 내보내고 있었다면 main.ejs 그림 파일을 내보냅니다.

router.get("/", function(req,res){

res.render('main',{title:"영화 리뷰 사이트"})

})

실제로 돌아가는지 확인

![](./img/194_img_1.png)

오류가 나네요

main.ejs 파일 문제인거같습니다.

<link rel="stylesheet" href="/public/main.css" />

![](./img/194_img_2.png)

app.use(helmet());

이게 막는거 같습니다.

주석처리 하겠습니다.

helmet은 보안정책이 심한것같군요

<https://www.npmjs.com/package/helmet>

[ helmet help secure Express/Connect apps with various HTTP headers. Latest version: 8.1.0, last published: 3 months ago. Start using helmet in your project by running `npm i helmet`. There are 5806 other projects in the npm registry using helmet. www.npmjs.com ](https://www.npmjs.com/package/helmet)

이 주소에 들어가보면 필요한 보안정책들만 꺼내서 사용해 볼 수 있다

// app.use(helmet());

그리고 또 이미지 파일이나 가져올 파일의 위치도 수정해줘야한다.

<img src="/public/logo.png" width="30" height="30" class="d-inline-block align-top" alt="" loading="lazy">

![](./img/194_img_3.png)

router.get("/", function(req,res){

res.render('main',{title:"영화 리뷰 사이트"})

})

앞서 이런식으로 tilte을 넘겼는데 main.ejs파일에서 받아서 제목으로 바꿔줍시다.

<title><%= locals.title %></title>

![](./img/194_img_4.png)

** 리뷰 저장 API 만들기**

* * *

![](./img/194_img_5.png)

영화 API 복습
    
    
    $.ajax({
            type: 'POST',
            url: '/api/reviews',
            contentType: 'application/json',
            data: JSON.stringify(review),
            success: function () {
              alert('후기 저장 완료!');
            },
            error: function () {
              alert('저장 실패');
            }
          });
        }

이런식으로 ajax를 사용해 남의 서버를 연결해서 후기보기버튼 후기 쓰기 버튼 함수 2개가 실행이 되고 내가 쓴 댓글이 올라가는 일련의 과정입니다.이때 저 영화 고유의 id를 통해 알맞은 데이터를 가져와야 합니다.

**mainRouter.js 수정**

* * *

일단 리뷰작성 댓글을 저장할 수 있는 SQL 파일 하나 만들겠습니다.

![](./img/194_img_6.png)

module.exports = function(sequelize, DataTypes){

return sequelize.define('reviews',{

idx: {

type:DataTypes.INTEGER,

autoIncrement:true,

primaryKey:true,

allwNull:false

},

movie_id: {

type:DataTypes.STRING(250)

},

review:{

type:DataTypes.TEXT

}

})

}

db.js에 알려주기

db.reviews = sequelize.import(__dirname + "/reviews.js");

mainRouter.js 수정하기

router.post("/review/create", function(req,res){

let movie_id = req.body.movie_id;

let review = req.body.review;

  


db.reviews.create({

movie_id:movie_id,

review:review

}).then(function(result){

res.send({success:200})

})

})

이제 외부 api로 리뷰를 받아왔던걸 수정하면 됩니다.

$.ajax({

url: `/reviews/create`, // 클라이언트가 요청을 보낼 서버의 URL 주소

data: {

movie_id:target_movie,

review:review

success:function(json){

console.log(json)

밑에 확인이 가능하게 console 함수도 넣어줍니다.

postman에서 확인해보기

![](./img/194_img_7.png)

잘보내지긴하지만 이런식으로만 하고 그만 둔다면 value값이 비어있던 0이던 success가 뜰꺼니까 수정해줍시다.

if(movie_id == '' || movie_id == 0){

res.send({success:400})

}else{

db.reviews.create({

movie_id:movie_id,

review:review

}).then(function(result){

res.send({success:200})

})

}

})

조건문으로 잘못된거는 400이나500 잘되면 200을 보내주는걸 프론트개발자한테 알려주게 합니다.

그리고 사용자한테도 알려줘서 다시 시도하게끔 main.ejs도 수정해줍니다.

if(json.success == 200){

console.log("저장이 잘된 경우")

}else if(json.success == 400){

alert("뭔가 잘못됐다. 데이터가 이상하다")

}

},

![](./img/194_img_8.png) ![](./img/194_img_9.png)

**리뷰 읽기 API 만들기**

* * *

GET방식으로 받을꺼라서 mainRouter.js파일에 추가해줍니다.

router.get("/review/read", function(req,res){

let movie_id = req.query.movie_id;

  


db.reviews.findAll({where:{movie_id:movie_id}}).then(function(result){

res.send({success:200, data:result})

})

  


})

main.ejs 파일의 주소도 바꿔줍니다.

$.ajax({

url: `/review/read?movie_id=${target_movie}`, // 클라이언트가 요청을 보낼 서버의 URL 주소

data: {}, // HTTP 요청과 함께 서버로 보낼 데이터 POST 방식에서만 사용

type: "GET", // HTTP 요청 방식(GET, POST)

success:function(json){

console.log(json)

let reviews = json.data;

for(let i=0; i<reviews.length; i++){

$(".modal-body").append(`<p>${reviews[i].review}</p>`)

}

},

error:function(e){

  


}

})

\

이 코드는 GET 방식으로 /review/read 엔드포인트에 movie_id 값을 쿼리 파라미터로 전달하여 해당 영화의 리뷰를 가져오는 역할을 합니다.

이제 웹사이트에서 확인해봅시다.

![](./img/194_img_10.png)

이런식으로 후기보기버튼을 눌르게 된다면 콘솔창에 object가 한개더 뜨는걸 볼 수 있습니다.

한번 후기를 써보겠습니다.

![](./img/194_img_11.png)

저장이 잘된 경우가 잘 뜹니다.

![](./img/194_img_12.png)

고유에 movie_id에 잘 저장이된거같습니다.


## 🔗 제텔카스텐 연결

### 관련 개념
- [[]]
- [[]]

### 프로젝트 연결
- [[]]

### 학습 포인트
-

## 📋 액션 아이템
- [ ]
- [ ]

## 💡 개인적 통찰



---

**태그**: #project웹개발
**상태**: 🌱 씨앗 (제텔카스텐 통합 대기)
**변환일**: 2025-10-07
